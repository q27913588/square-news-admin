# 煽動指數分析管理頁面使用指南

## 📋 功能概述

這個管理頁面幫助您：
- ✅ 查看所有事件的煽動指數分析狀態
- ✅ 一鍵批量分析未分析的事件
- ✅ 快速定位需要處理的事件
- ✅ 實時查看分析進度

---

## 🚀 部署步驟

### 1. 添加路由

編輯 `src/router/index.ts`，添加新路由：

```typescript
{
  path: '/admin/incitement',
  name: 'IncitementManagement',
  component: () => import('@/views/admin/IncitementManagementView.vue'),
  meta: { requiresAuth: true, title: '煽動指數管理' }
}
```

### 2. 添加導航菜單

編輯 `src/views/admin/AdminLayout.vue`（如果有側邊欄的話）：

```vue
<n-menu-item key="incitement" @click="router.push('/admin/incitement')">
  <template #icon>
    <n-icon><AnalyticsOutline /></n-icon>
  </template>
  煽動指數管理
</n-menu-item>
```

### 3. 安裝依賴（如果需要）

```bash
npm install @vicons/ionicons5
```

---

## 🎨 頁面功能說明

### 頁面結構

```
┌─────────────────────────────────────┐
│  📊 統計卡片                         │
│  總事件數 | 已分析 | 未分析 | 部分   │
├─────────────────────────────────────┤
│  🔍 篩選器                          │
│  狀態篩選 | 主題搜尋                 │
├─────────────────────────────────────┤
│  📋 事件列表表格                     │
│  ID | 主題 | 狀態 | 文章數 | 操作   │
└─────────────────────────────────────┘
```

### 功能詳解

#### 1️⃣ 統計卡片
顯示整體分析狀態：
- **總事件數**：系統中的所有事件
- **已分析**：所有文章都已分析的事件
- **未分析**：沒有任何分析數據的事件
- **部分分析**：只有部分文章被分析的事件

#### 2️⃣ 篩選功能
- **狀態篩選**：
  - 全部
  - 已分析
  - 未分析
  - 部分分析

- **主題搜尋**：即時搜尋事件主題

#### 3️⃣ 事件列表
每個事件顯示：
- **ID**：事件編號
- **主題**：事件名稱
- **狀態**：
  - 🟢 已分析（綠色勾勾）
  - 🟡 部分分析（橙色時鐘）
  - 🔴 未分析（紅色警告）
- **文章數**：事件包含的文章總數
- **已分析**：已分析的文章數和百分比
- **媒體數**：參與報導的媒體數量
- **更新時間**：最後更新時間

#### 4️⃣ 操作按鈕
- **分析**：為單個事件執行煽動指數分析
- **查看光譜**：打開事件的立場光譜頁面

#### 5️⃣ 批量分析
點擊「批量分析」按鈕，可選擇：
- **只分析未分析的事件**：效率最高
- **只分析部分分析的事件**：補齊缺失數據
- **分析所有事件**：重新分析所有數據
- **分析選中的事件**：手動選擇要分析的事件

---

## 💡 使用場景

### 場景 1：系統升級後初次使用
**目標**：為所有舊事件補充煽動指數分析

**步驟**：
1. 打開管理頁面
2. 查看統計，了解有多少未分析的事件
3. 點擊「批量分析」
4. 選擇「只分析未分析的事件」
5. 點擊「開始分析」
6. 等待進度條完成

**時間估算**：
- 100 個事件 × 10 篇文章 × 5 秒 = 約 1.5 小時

---

### 場景 2：日常維護
**目標**：檢查是否有事件需要補充分析

**步驟**：
1. 打開管理頁面
2. 切換到「未分析」或「部分分析」
3. 對需要的事件點擊「分析」
4. 或使用批量分析功能

**頻率建議**：每週一次

---

### 場景 3：特定事件分析
**目標**：為某個重要事件重新分析或補充分析

**步驟**：
1. 在搜尋框輸入事件主題關鍵字
2. 找到目標事件
3. 點擊「分析」按鈕
4. 確認並開始分析
5. 分析完成後點擊「查看光譜」

---

### 場景 4：查看分析覆蓋率
**目標**：了解整體分析完成度

**步驟**：
1. 查看頂部統計卡片
2. 重點關注「未分析」和「部分分析」的數量
3. 如果比例過高（>20%），建議執行批量分析

---

## 📊 狀態判定邏輯

```typescript
if (已分析文章數 === 0) {
  狀態 = "未分析" // 🔴
} else if (已分析文章數 < 總文章數) {
  狀態 = "部分分析" // 🟡
} else {
  狀態 = "已分析" // 🟢
}
```

---

## ⚠️ 注意事項

### 1. 批量分析時間
- 每篇文章約需 **5-10 秒**
- 建議在**低峰時段**執行大批量分析
- 系統會自動跳過已分析的文章

### 2. 成本估算
- 每篇文章約 **$0.01-0.02 USD**
- 1000 篇文章約 **$10-20 USD**
- 請根據預算規劃批量分析範圍

### 3. 錯誤處理
- 單個事件分析失敗不會影響其他事件
- 失敗的事件會在日誌中記錄
- 可以重新執行分析（會跳過成功的）

### 4. 性能優化
- 頁面加載可能需要 **5-10 秒**（需要檢查所有事件狀態）
- 建議使用篩選器減少顯示的事件數量
- 可以考慮添加快取機制

---

## 🔧 自定義配置

### 修改每頁顯示數量
```vue
const pagination = ref({
  page: 1,
  pageSize: 50,  // 改為 50
  showSizePicker: true,
  pageSizes: [20, 50, 100, 200]  // 自定義選項
})
```

### 添加更多篩選條件
```vue
// 例如：按事件狀態篩選
<n-select
  v-model:value="filterEventState"
  :options="[
    { label: 'OPEN', value: 'OPEN' },
    { label: 'CLOSED', value: 'CLOSED' }
  ]"
  placeholder="事件狀態"
/>
```

---

## 🐛 常見問題

### Q: 為什麼頁面加載很慢？
A: 因為需要查詢所有事件的分析狀態。解決方案：
1. 後端添加專用 API 返回分析狀態
2. 添加分頁或虛擬滾動
3. 使用快取

### Q: 批量分析中斷了怎麼辦？
A: 可以重新執行，系統會自動跳過已成功的事件。

### Q: 如何查看分析失敗的原因？
A: 查看瀏覽器控制台或後端日誌。

### Q: 可以取消正在進行的批量分析嗎？
A: 當前版本不支持取消。建議：
1. 先測試少量事件
2. 確認無誤後再批量執行

---

## 🚀 未來改進建議

### 短期（1-2 週）
- [ ] 添加後端專用 API 提升加載速度
- [ ] 添加分析失敗原因顯示
- [ ] 支持取消批量分析

### 中期（1 個月）
- [ ] 添加定時任務自動分析新事件
- [ ] 添加分析成本估算
- [ ] 支持導出分析報告

### 長期（3 個月）
- [ ] 添加分析質量評估
- [ ] 支持自定義分析規則
- [ ] 添加分析歷史記錄

---

## 📞 技術支援

如遇問題，請查看：
1. 瀏覽器控制台錯誤
2. 後端日誌
3. 網絡請求狀態

---

**更新日期**: 2026-01-20  
**版本**: v1.0
